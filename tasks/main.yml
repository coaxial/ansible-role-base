---
- name: Disable users' passwords
  user:
    - name: "{{ item }}"
    - password: "!!"
    - state: present
  with_items:
    - root
    - user
    - ansible

- name: Enable passwordless sudo
  lineinfile:
    path: /etc/sudoers
    state: present
    regexp: '^{{ item }}\s'
    line: '{{ item }} ALL=(ALL) NOPASSWD: ALL'
    validate: 'visudo -cf %s'
    with_items:
      - user
      - ansible
